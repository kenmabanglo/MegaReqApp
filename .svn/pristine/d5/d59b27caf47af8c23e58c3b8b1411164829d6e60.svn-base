<form class="talent-form-request" [formGroup]="requestForm">

    <!-- HEADERS SECTION upper-->
    <ng-container formArrayName="request">
         
        <mat-form-field appearance="fill">
            <mat-label>Request Date</mat-label>
            <input matInput readonly value="{{ requestDate | date: 'shortDate' }}">
        </mat-form-field>
 
        <mat-form-field>
            <mat-label>Select Department Requisitioning</mat-label>
            <mat-select formControlName="departmentRequesting" [(value)]="depreq">
                <!-- <mat-option value=''>None</mat-option>  -->
                <mat-option *ngFor="let c of departments; " [value]="c.departmentCode">
                    {{c.departmentName }}
                </mat-option>
            </mat-select>  
        </mat-form-field> 
 
        <mat-form-field>
            <mat-label>Date Filed</mat-label>
            <input matInput [matDatepicker]="picker" placeholder="Date Filed" 
                formControlName="fileDate">
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>

     
        <mat-form-field>
            <mat-label>Position being Requisitioned</mat-label>
            <input matInput formControlName="position">
        </mat-form-field>


        <mat-form-field>
            <mat-label>Select Department</mat-label>
            <mat-select formControlName="department" [(value)]="dept">
                <!-- <mat-option value=''>None</mat-option>  -->
                <mat-option *ngFor="let c of departments; " [value]="c.departmentCode">
                    {{c.departmentName }}
                </mat-option>
            </mat-select>  
        </mat-form-field> 

        <mat-form-field>
            <mat-label>No.</mat-label>
            <input matInput type="number" formControlName="noOfTalent">
        </mat-form-field>

        <!-- REASON -->

        <mat-form-field>
            <mat-label>Select Reason for Requisition</mat-label>
            <mat-select formControlName="requestReason" [(value)]="reason">
                <!-- <mat-option value=''>None</mat-option>  -->
                <mat-option *ngFor="let c of reasons; " [value]="c.id">
                    {{c.description }}
                </mat-option>
            </mat-select>  
        </mat-form-field> 

       <ng-container>
            <mat-form-field *ngIf="reason == '4'">
                <mat-label>Resignation Of</mat-label>
                <input matInput formControlName="resignationOf">
            </mat-form-field>

            <mat-form-field  *ngIf="reason == '5'">
                <mat-label>Transfer Of</mat-label>
                <input matInput formControlName="transferOf">
            </mat-form-field>

            <mat-form-field *ngIf="reason == '5'">
                <mat-label>Transfer From</mat-label>
                <input matInput formControlName="transferFrom">
            </mat-form-field >

            <mat-form-field *ngIf="reason == '5'">
                <mat-label>Transfer To</mat-label>
                <input matInput formControlName="transferTo">
            </mat-form-field>
    
            <mat-form-field *ngIf="reason == '6'">
                <mat-label>Termination Of</mat-label>
                <input matInput formControlName="terminationOf">
            </mat-form-field>

            <mat-form-field *ngIf="reason == '6'">
                <mat-label>Effectivity Date</mat-label>
                <input matInput [matDatepicker]="picker" placeholder="Effectivity Date" 
                    formControlName="terminationEffectiveDate">
                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>
       </ng-container>

        <!-- END REASON -->

        <!-- EMPLOYMENT STATUS -->

        <mat-form-field>
            <mat-label>Select Employment Status</mat-label>
            <mat-select formControlName="employmentStatus" [(value)]="stat">
                <!-- <mat-option value=''>None</mat-option>  -->
                <mat-option *ngFor="let c of emp_status; " [value]="c.id">
                    {{c.description }}
                </mat-option>
            </mat-select>  
        </mat-form-field> 
        
        <ng-container>
            <mat-form-field *ngIf="stat == '1'">
                <mat-label>Regular with months of probationary</mat-label>
                <input matInput type="number" formControlName="empProbationaryMonths">
            </mat-form-field>
    
            <mat-form-field *ngIf="stat == '2'">
                <mat-label>Name of Project</mat-label>
                <input matInput formControlName="empProjectName">
            </mat-form-field>
    
            <mat-form-field *ngIf="stat == '2'">
                <mat-label>Duration of Project</mat-label>
                <input matInput formControlName="empProjectDuration">
            </mat-form-field>
    
            <mat-form-field *ngIf="stat == '3'">
                <mat-label>Others (specify)</mat-label>
                <input matInput formControlName="employmentOthers">
            </mat-form-field>
        </ng-container>
        
         <!-- END EMPLOYMENT STATUS -->

         <mat-form-field class="full-width">
            <mat-label>Description of Duties: </mat-label>
            <textarea matInput #description placeholder="Description of Duties" rows="3" cdkTextareaAutosize 
            formControlName="descriptionOfDuties" maxlength="500">

            <mat-hint align="end">{{description.value.length}} / 500</mat-hint>
            </textarea>
        </mat-form-field> 

        <mat-form-field >
            <mat-label>Basic Salary</mat-label>
            <input matInput type="text" formControlName="basicSalary" 
            inputWithComma required="true"
            >
            <mat-error *ngIf="hasError('basicSalary', 'required')">This field is required</mat-error>
            <mat-error *ngIf="hasError('basicSalary', 'pattern')">Only digits are allowed.</mat-error>
        </mat-form-field>

        <mat-form-field>
            <mat-label>Allowances</mat-label>
            <mat-select formControlName="allowances" multiple  [(value)]="selected_allowances"
            (selectionChange)="allowanceChange($event.value);">
              <mat-option *ngFor="let a of allowances_list" [value]="a.id">
                {{a.description}}</mat-option>
            </mat-select>
        </mat-form-field>
      
        <mat-form-field *ngIf="allowanceOthers">
            <mat-label> Allowance Others (specify)</mat-label>
            <input matInput formControlName="allowanceOthers" required>
        </mat-form-field>

        <mat-form-field>
            <mat-label>Benefits Package</mat-label>
            <mat-select formControlName="benefits" multiple  [(value)]="selected_benefits"
            (selectionChange)="benefitsChange($event.value);">
              <mat-option *ngFor="let a of benefits_list" [value]="a.id">
                {{a.description}}</mat-option>
            </mat-select>
        </mat-form-field>
      
        <mat-form-field *ngIf="benefitsOthers">
            <mat-label> Benefits Others (specify)</mat-label>
            <input matInput formControlName="benefitsOthers" required>
        </mat-form-field>

         <mat-form-field>
            <mat-label>Is this position budgeted?</mat-label>
            <mat-select formControlName="isPositionBudgeted">
                <mat-option *ngFor="let b of budgeted" [value]="b">
                    {{b | uppercase}}
                </mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field>
            <mat-label>How many employees are in this at present?</mat-label>
            <input matInput type="number" formControlName="noOfTalent">
        </mat-form-field>


        

    </ng-container>
 
 
 
    <!-- BUTTONS SECTION --> 
    <div
        class="request-form-actions">
         <!-- (click)="uploadAttachments()" -->
            <button mat-raised-button
            color="accent" matTooltip="Upload Attachments">
                <mat-icon>upload</mat-icon>
                UPLOAD 
                <span class="hide-mobile">
                    ATTACH</span>
            </button> 

            <button mat-raised-button
                color="warn" matTooltip="Close Request">
                <mat-icon>close</mat-icon>
                <span class="hide-mobile">
                CLOSE</span>
            </button>
            
            <button mat-raised-button type="submit" [disabled]="isSaving"
            color="primary" matTooltip="Save Request">

            <ng-container *ngIf="!isSaving; else process">
                <mat-icon>check_circle</mat-icon> SAVE
            </ng-container>
            <ng-template #process>
                <span class="processing">PROCESSING  <mat-spinner diameter="15"></mat-spinner></span>
            </ng-template>
 
            </button> 
       
    </div>    
</form>
  